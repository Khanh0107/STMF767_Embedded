# SPI (Serial Peripheral Interface)

## 1. What is SPI

### 1.1 Key Features
- **Synchronous** → Uses a clock signal for synchronization.
- **Full-duplex** → Data is transmitted and received simultaneously.
- **High speed** → Typically faster than I²C and UART.
- **Master-Slave architecture** → One master controls one or more slaves.
- **Simple hardware lines** (but requires more pins than I²C).

---

### 1.2. SPI Signals
SPI uses **four main lines**:

| Signal | Direction | Description |
|--------|-----------|-------------|
| **MOSI** (Master Out Slave In) | Master → Slave | Data sent from master to slave |
| **MISO** (Master In Slave Out) | Slave → Master | Data sent from slave to master |
| **SCLK** (Serial Clock) | Master → Slave | Clock signal generated by the master |
| **SS / CS** (Slave Select / Chip Select) | Master → Slave | Selects which slave to communicate with (active low) |

> If multiple slaves are present, each requires its own **CS** line.

<img width="412" height="305" alt="image" src="https://github.com/user-attachments/assets/9d9506de-405e-4800-ae36-33fa50a56c30" />

---

## 1.3. How SPI Works

- Step 1. The master pulls **CS** low to select a slave.
- Step 2. The master generates clock pulses on **SCLK**.
- Step 3. On each clock cycle:
   - Master sends a bit on **MOSI**.
   - Slave sends a bit on **MISO**.
   - Both sides sample the data at the defined clock edge.
- Step 4. The master sets **CS** high to end communication.

<img width="399" height="210" alt="image" src="https://github.com/user-attachments/assets/5adeeb8b-3e7b-4782-943d-8d4e6c39dd29" />

---

**Example simulate**

<img width="515" height="619" alt="image" src="https://github.com/user-attachments/assets/0eec5524-e9cb-4717-a32a-b802d0767663" />

<img width="1567" height="421" alt="image" src="https://github.com/user-attachments/assets/5819403a-0e61-4758-b42e-459dffa3aed2" />

<img width="511" height="370" alt="image" src="https://github.com/user-attachments/assets/f573d74f-8415-4101-9676-201e8ea9baeb" />

---

## 1.4. Clock Polarity & Phase
SPI supports **4 modes**, determined by:

- **CPOL**: Clock polarity (idle state of the clock).
- **CPHA**: Clock phase (data sampled on leading or trailing clock edge).

| Mode | CPOL | CPHA | Clock Idle | Data Sampled On |
|------|------|------|-------------|-----------------|
| 0 | 0 | 0 | Low | Rising edge |
| 1 | 0 | 1 | Low | Falling edge |
| 2 | 1 | 0 | High | Falling edge |
| 3 | 1 | 1 | High | Rising edge |

<img width="778" height="375" alt="image" src="https://github.com/user-attachments/assets/f987e58e-887f-47c3-a5f2-8358b27b5a8c" />

## 2. Practice with LCD TFT RGB 240x320 ILI9341

### 2.1. What is LCD TFT RGB 240x320 ILI9341

- LCD → Liquid Crystal Display, a display technology using liquid crystals and a backlight.
- TFT → Thin-Film Transistor, a type of LCD that uses active matrix technology for better color, contrast, and refresh speed compared to simple passive LCDs.
- Each pixel = 3 sub-pixels (R + G + B). Red, Green, Blue sub-pixels combine to produce full-color images (commonly 16-bit RGB565 or 18-bit RGB666)

### 2.2. Set up

| LCD  | Function       | STM32 Pin  |
|---------|-----------------|-------------------|
| CS     | Chip select              | PA4               |
| RESET     | Clock           | PA0                |
| GND    | Ground        | GND |
| VCC    | VCC        | 5V |
| DC     | Data or command           | PA2               |
| MOSI    | Ground        | PA7 |
| SCK    | Clock        | PA5 |
| LED    | Back light        | 3.3V |















